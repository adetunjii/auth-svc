syntax = "proto3";
option go_package = "internal/proto";
package auth;

import "google/protobuf/empty.proto";

message LoginRequest {
   string email = 1;
   string password = 2;
}
message LoginResponse {
  string message = 1;
  string requestId = 2;
}

message RegisterRequest {
  string firstName = 1;
  string lastName = 2;
  string email = 3;
  string phoneNumber = 4;
  string password = 5;
  string address = 6;
  string state = 7;
  string country = 8;
}

message RegisterResponse {
  string message= 1;
  string userReference = 2;
}

message InitEmailVerificationRequest {
  string email = 1;
  string type = 2;
}

message InitEmailVerificationResponse {
  string message = 1;
  string requestId = 2;
  enum OtpType {
    LOGIN = 0;
    REG = 1;
  }
  OtpType type = 3;
}

message InitPhoneVerificationRequest {
  string phone = 1;
}

message InitPhoneVerificationResponse {
  string message = 1;
}

message EmailVerificationRequest {
  string requestID = 1;
  string otp = 2;
  string email = 3; 
  enum OtpType {
    LOGIN = 0;
    REG = 1;
  }
  OtpType type = 4;
}

message VerifyLoginRequest {
  string email = 1;
  string requestId = 2;
  string otp = 3;
  enum OtpType {
    LOGIN = 0;
    REG = 1;
  }
  OtpType type = 4;
}

message VerifyLoginResponse {
  string token = 1;
}

message EmailVerificationResponse {
  string message = 1;
}

message LogoutRequest {
  string user_id = 1;
}

message LogoutResponse {
  string message = 1;
}

message Country {
  int32 id = 1;
  string name = 2;
  string iso = 3;
  string phoneCode = 4;
}

message GetAllCountryResponse {
  repeated Country countries = 1;
}

service AuthService{
  rpc Login(LoginRequest) returns (LoginResponse) {}
  rpc Register(RegisterRequest) returns (RegisterResponse) {}
  rpc InitEmailVerification(InitEmailVerificationRequest) returns (InitEmailVerificationResponse) {}
  rpc InitPhoneVerification(InitPhoneVerificationRequest) returns (InitPhoneVerificationResponse) {}
  rpc VerifyEmail(EmailVerificationRequest) returns (EmailVerificationResponse) {}
  rpc VerifyLogin(VerifyLoginRequest) returns (VerifyLoginResponse) {}
  rpc Logout (LogoutRequest) returns (LogoutResponse){}
  rpc GetAllCountries(google.protobuf.Empty) returns (GetAllCountryResponse) {}
}